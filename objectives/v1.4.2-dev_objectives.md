# PROJECT_OBJECTIVES.md

## KTP Website: Project Objectives

This project delivers a secure, modern web presence for KTP Digital, built for easy management, analytics, and continual improvement.

### Core Goals:
- Provide a simple, maintainable, and secure PHP/Tailwind website
- Support rapid deployment and rollback using ZIP snapshots and Git
- Centralize all administration and analytics under `/admin`
- Log and visualize site usage for ongoing market segmentation and SEO optimization
- Ensure that objectives and change history are always visible and versioned
- Enable seamless future migration from `ww2.ktp.digital` to `www.ktp.digital` with no hardcoded subdomain logic
- Keep all navigation and assets relative or config-driven for environment portability

### Admin/Analytics Roadmap:
- Admin hub at `/admin/`
- Download any snapshot or log file from the admin panel
- Track pageviews, user agents, referers, and IPs for traffic analysis
- Show version and objectives history in a human-readable form
- Allow secure access (username+password, then later OIDC or SSO)
- Future: Expose key site settings and SEO controls to admin panel

---
### Remote Workflow Support:
- All project management, file editing, and admin must be fully operable via SSH and SCP from a Mac (or other remote system)
- No required steps may assume local desktop GUI access; everything must be executable from a remote shell/editor (vim/nano) or via secure file copy
- All code, admin tools, and setup steps must support headless remote operation (no manual web uploads or GUI installers)

## Objectives & Changelog for v1.4.2-dev
*Created: 2025-05-20 18:04:43 AEST*

---

---
#### [2025-05-20 18:09:56 AEST][v1.4.2-dev]
Core objective of this release is to get analytics working

---
#### [2025-05-20 19:26:42 AEST][v1.4.2-dev]
## üöÄ Automated Pushover Integration for Version Bumps

### üõ†Ô∏è What Changed
- **New reusable notification script:** `/opt/webstack/bin/notify_pushover.sh`  
  ‚Üí Accepts message, title, URL, button label, sound, and priority!
- **Updated deploy workflow:** `/opt/webstack/bin/update_version.sh`  
  ‚Üí Now sends a rich Pushover alert on every version bump, with:
    - üì¶ Version and timestamp
    - üîó Direct button to snapshots page (`/admin/maintenance.php`)
    - ü™© Custom Stones "Intro" sound
    - üö® High-priority (+1) notification

### üßë‚Äçüíª Example Notification
- **Sound:** Stones Satisfaction Intro  
- **Priority:** High (bypasses quiet hours!)

### üìù Usage Pattern
1. Version bump triggers snapshot, commit, objectives update, and push.
2. Pushover script sends notification with all details and a clickable link.
3. Receive instant deploy alerts with custom sound and priority right on your device!

---

**Tested and confirmed working in v1.4.3-dev!** üèÅ

---
#### [2025-05-20 19:30:32 AEST][v1.4.2-dev]
now we get to the the final meat of this release analytics we need a comprehensive analytics page in admin that we can use for SCO SEO whatever the terms are that tracks speeds and usage of the website

---
#### [2025-05-20 19:31:33 AEST][v1.4.2-dev]
Comprehensive Analytics Requirements

1. What to Track:

Traffic: Pageviews, unique visitors, top pages, referrers, and user agents
Performance: Load times, average response time, slowest endpoints
SEO/SCO: Search terms (if available), crawl activity, top entry/exit pages, bounce rates
Geography: Top countries/cities (if possible)
Live/Recent activity: Last 10/100 visits, with time, IP, path, agent
Retention: Returning vs new users (cookie or IP-based, optional)
2. How to Collect:

Server-side PHP logging: Each page request appends to a log file (or MariaDB later)
Log: timestamp, IP, user-agent, referrer, request URI, response time (microtime diff), status code
JS beacon (optional): For real user timing, but keep initial version PHP-only
3. How to Display:

/admin/analytics.php (strictly admin-only):
Beautiful Tailwind dashboard
Graphs: Traffic over time, load times, top pages, top referrers
Tables: Recent hits, user agent breakdown, country/city (if using GeoIP)
SEO insights: Top landing pages, referrers with search queries
Summary stats: Uptime, avg load, total users/pages

---
#### [2025-05-20 19:43:55 AEST][v1.4.2-dev]
time for some cleanup anyway.  Why don't you do some analysis of all the php/html files in the /html recursively I'm guessing with the first 20 lines or something of each file you can figure out whether it's using nav.php or header.php (I don't think we have one) and then come up with A and understanding of the current structure e.g. what's current or not been used in a while so that we can potentially clean up files and or sed everything with and update

---
#### [2025-05-20 19:45:14 AEST][v1.4.2-dev]
Great approach. Here‚Äôs how we‚Äôll proceed:

Recursively list all .php and .html files under /opt/webstack/html.
Show the first 20 lines of each file to check for includes (especially nav.php, header.php, or analytics_logger.php).
Summarize which includes are used, spot old/unused files, and build a cleanup/update plan.
Prepare a sed or script action for mass-injecting the analytics logger if possible.
Step 1: List All PHP/HTML Files and Their First 20 Lines

Run this command on your server:

---
#### [2025-05-20 19:45:28 AEST][v1.4.2-dev]
find /opt/webstack/html -type f \( -name "*.php" -o -name "*.html" \) -exec echo "==== {} ====" \; -exec head -20 {} \;

---
#### [2025-05-20 19:45:54 AEST][v1.4.2-dev]
Step 2: What to Do With This Output

Paste/upload the result here, or scan it for include 'nav.php' or any header pattern.
I‚Äôll analyze which files use what includes and which don‚Äôt.
I‚Äôll identify:
Pages that already have a common include (good for global patching)
Pages missing it (candidates for direct logger injection)
Potentially old or unused files (by filename/location/structure)
Step 3: Cleanup & Automation Plan

After analysis, I‚Äôll:

Tell you which files can be auto-patched in bulk (with sed or a small script).
Recommend deleting or archiving old/unused files.
Give you a command to inject the logger at the top of all needed PHP files, safely.

---
#### [2025-05-20 19:46:26 AEST][v1.4.2-dev]
root@ssdnodes-605e9a6080011:/opt/webstack/bin# find /opt/webstack/html -type f \( -name "*.php" -o -name "*.html" \) -exec echo "==== {} ====" \; -exec head -20 {} \;
==== /opt/webstack/html/index-test.php ====
<?php include("nav.php"); ?>
<div class="pt-24 sm:pt-20"></div>
<?php
  $version = trim(file_get_contents('/opt/webstack/html/VERSION'));
  $bg = "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&w=1600&q=80";
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.tailwindcss.com"></script>
  <title>KTP Digital | Smarter IT</title>
  <style>
    body {
      background-image: url('<?= $bg ?>');
      background-size: cover;
      background-position: center;
    }
    .backdrop {
==== /opt/webstack/html/about.php ====
<?php
require 'layout.php';

$page_title = "About Us";

$content = <<<HTML
<section class="max-w-6xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">üëã About Us</h1>
  <p class="mb-6 text-lg">
    With over 35 years of experience across Asia-Pacific, the US, and Europe, we‚Äôve helped customers navigate every major technology wave ‚Äî from mainframes to cloud, from passwords to passkeys, and from hardware to automation.
  </p>
  <p class="mb-6 text-lg">
    KTP Digital is led by seasoned professionals with deep roots in cybersecurity, identity management, automation, and scalable infrastructure. We've worked with major vendors and global customers across both the enterprise and public sectors.
  </p>
  <p class="mb-6 text-lg">
    Today, we deliver tailored solutions for networking, security, automation, and system reliability ‚Äî from small businesses to large-scale enterprise deployments.
  </p>
</section>
HTML;

==== /opt/webstack/html/nav.php ====
<nav class="bg-white dark:bg-black/90 fixed top-0 w-full shadow z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex justify-between items-center">
    <a href="index.php" class="flex items-center space-x-2">
      <picture>
        <source srcset="images/logos/KTP Logo2.png" media="(prefers-color-scheme: dark)">
        <img src="/images/logos/KTP Logo.png" alt="KTP Logo" class="h-8 w-auto">
      </picture>
      <span class="font-bold text-gray-900 dark:text-white text-lg">KTP Digital</span>
    </a>

    <!-- Hamburger toggle -->
    <button id="nav-toggle" class="md:hidden text-gray-900 dark:text-white focus:outline-none transition-transform duration-300 ease-in-out">
      <svg id="icon-hamburger" class="w-6 h-6 block" fill="none" stroke="currentColor" stroke-width="2"
           viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 6h16M4 12h16M4 18h16" />
      </svg>
      <svg id="icon-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" stroke-width="2"
           viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 18L18 6M6 6l12 12" />
      </svg>
==== /opt/webstack/html/Parsedown.php ====
<?php

#
#
# Parsedown
# http://parsedown.org
#
# (c) Emanuil Rusev
# http://erusev.com
#
# For the full license information, view the LICENSE file that was distributed
# with this source code.
#
#

class Parsedown
{
    # ~

    const version = '1.8.0';
==== /opt/webstack/html/layout.php ====
<?php
function renderLayout($page_title, $content) {
    $version = @trim(file_get_contents(__DIR__ . '/VERSION'));
    $updated = date('Y-m-d H:i:s');

    ob_start();
    ?>
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script src="https://cdn.tailwindcss.com"></script>
        <title><?php echo htmlspecialchars($page_title); ?></title>
        <style>
            body {
                background-image: url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&w=1600&q=80');
                background-size: cover;
                background-position: center;
            }
==== /opt/webstack/html/mac.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apple ‚Äî Since 1984</title>
  <style>
    body {
      background: url('images/mac/hero.jpg') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
    }
  </style>
</head>
<body class="text-white">
<?php include 'nav.php'; ?>
  <div class="min-h-screen px-6 py-10 flex items-center justify-center">
    <div class="bg-black bg-opacity-60 rounded-lg p-8 max-w-4xl">
      <h1 class="text-4xl font-extrabold mb-6 text-blue-200">Apple Technology ‚Äî Since 1984</h1>

      <p class="text-lg mb-4 leading-relaxed">
==== /opt/webstack/html/admin/test.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Button ‚Äì KTP Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/assets/tailwind.min.css">
</head>
<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white">
  <div class="max-w-lg mx-auto py-12">
    <h1 class="text-2xl font-bold mb-6">Delete Button as Div</h1>
    <div class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-base font-medium shadow transition focus:outline-none focus:ring-2 focus:ring-red-300 cursor-pointer">
      Delete
    </div>
    <p class="mt-8">You should see a red "Delete" 'button' as a div with the word Delete.</p>
  </div>
</body>
</html>
==== /opt/webstack/html/admin/maintenance.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Maintenance ‚Äì KTP Digital</title>
  <meta name="description" content="Download Webstack snapshot backups and view deployment history.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white">
<?php include 'nav.php'; ?>

<?php
  // --- Handle Delete Action ---
  $snapshot_dir = __DIR__ . '/../snapshots';
  if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete_file'])) {
    $del_file = basename($_POST['delete_file']);
    $del_path = "$snapshot_dir/$del_file";
    if (is_file($del_path)) {
      unlink($del_path);
==== /opt/webstack/html/admin/changes.php ====
<?php
// Path config (define FIRST, outside any block)
$objectives_dir = '/opt/webstack/objectives';
$allowed_exts = ['md', 'txt'];

// Escape helper (define BEFORE any usage)
function md_escape($s) {
    return htmlspecialchars($s, ENT_QUOTES | ENT_SUBSTITUTE, 'UTF-8');
}

$files = array_filter(scandir($objectives_dir), function($f) use ($allowed_exts, $objectives_dir) {
    $ext = pathinfo($f, PATHINFO_EXTENSION);
    return in_array($ext, $allowed_exts) && !is_dir("$objectives_dir/$f");
});

// Handle file view or download
if (isset($_GET['file'])) {
    $file = basename($_GET['file']);
    $filepath = "$objectives_dir/$file";
    if (!in_array($file, $files)) {
==== /opt/webstack/html/tailscale.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tailscale ‚Äì KTP Digital</title>
  <meta name="description" content="Tailscale VPN solutions by KTP Digital ‚Äì secure networking made simple.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800 dark:bg-gray-900 dark:text-white">
<?php include 'nav.php'; ?>
  <div class="max-w-5xl mx-auto p-6 pt-20">
    <h1 class="text-4xl font-bold mb-4">üîí Tailscale VPN Solutions</h1>
    <p class="mb-6 text-lg">
      Tailscale is a mesh VPN that makes secure networking effortless for small teams, remote workers, and complex multi-site environments.
    </p>

    <div class="grid md:grid-cols-2 gap-6 mb-10">
      <div class="p-4 border rounded-lg dark:border-gray-700 shadow">
        <h2 class="text-2xl font-semibold mb-2">Zero Configuration</h2>
==== /opt/webstack/html/smallbiz.php ====
<?php
require 'layout.php';

$page_title = "Small Business Solutions";

$content = <<<HTML
<section class="max-w-6xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">üè¢ Small Business Solutions</h1>
  <p class="mb-6 text-lg">
    We help small businesses secure, monitor, and connect their environments using the best technology ‚Äî simply and affordably.
  </p>
  <ul class="list-disc list-inside text-left text-lg space-y-2">
    <li>Cloud Gateway routing and VPN</li>
    <li>Ubiquiti Protect camera systems</li>
    <li>Access Control with facial and license plate recognition</li>
    <li>Local backup, monitoring, and alerting</li>
    <li>NAS integration ‚Äî QNAP, Synology, and Docker services</li>
    <li>Remote support, secure tunnels (Tailscale), and DNS control (NextDNS)</li>
  </ul>
  <p class="mt-6 text-lg">
==== /opt/webstack/html/nextdns.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NextDNS ‚Äì KTP Digital</title>
  <meta name="description" content="NextDNS filtering and privacy solutions by KTP Digital ‚Äì secure DNS for home and business.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800 dark:bg-gray-900 dark:text-white">
<?php include 'nav.php'; ?>
  <div class="max-w-5xl mx-auto p-6 pt-20">
    <h1 class="text-4xl font-bold mb-4">üõ°Ô∏è NextDNS Protection</h1>
    <p class="mb-6 text-lg">
      NextDNS brings enterprise-grade content filtering, analytics, and security to your network with no hardware required.
    </p>

    <div class="grid md:grid-cols-2 gap-6 mb-10">
      <div class="p-4 border rounded-lg dark:border-gray-700 shadow">
        <h2 class="text-2xl font-semibold mb-2">Real-Time Filtering</h2>
==== /opt/webstack/html/contact.php ====
<?php
require 'layout.php';

$page_title = "Contact";

$content = <<<HTML
<section class="max-w-4xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">üì¨ Contact</h1>
  <p class="text-lg mb-4">
    Reach out to us for a consult, project quote, or just to explore ideas. We're happy to help.
  </p>
  <p class="text-lg mb-2">
    üìß Email: <a href="mailto:jason@jasonhollis.com" class="underline text-green-300">jason@jasonhollis.com</a>
  </p>
  <p class="text-lg">
    üåê LinkedIn: <a href="https://linkedin.com/in/jasonforresthollis" class="underline text-blue-300" target="_blank">Jason Hollis</a>
  </p>
</section>
HTML;

==== /opt/webstack/html/test.php ====
<!DOCTYPE html>
<html>
<head>
  <title>Tailwind Test</title>
  <link rel="stylesheet" href="/assets/css/tailwind.min.css">
</head>
<body class="bg-gray-100">
  <div class="bg-red-500 text-white text-2xl p-6 m-6 rounded shadow">
    TAILWIND TEST PAGE
  </div>
</body>
</html>
==== /opt/webstack/html/ping.php ====
<?php echo "‚úÖ TEST WORKS"; ?>
==== /opt/webstack/html/nas.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NAS & Storage Solutions</title>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
<?php include 'nav.php'; ?>
  <div class="p-8 max-w-5xl mx-auto">
    <img src="images/nas/qnap-banner.jpg" alt="QNAP TS-h1290FX" class="rounded shadow mb-8 w-full max-h-96 object-contain">

    <h1 class="text-3xl font-bold mb-6">NAS & Storage Solutions</h1>

    <p class="text-lg leading-relaxed mb-6">
      We‚Äôve been working with both <strong>QNAP</strong> and <strong>Synology</strong> systems since 2008, helping customers deploy robust, secure, and scalable on-premise storage solutions across mixed Mac and Windows environments.
    </p>

    <p class="text-md mb-6 text-blue-700 dark:text-blue-300">
      Many of our customers operate in regulated industries where cloud storage is either restricted, discouraged, or requires enhanced oversight. We provide trusted alternatives that keep data under your control ‚Äî with compliance, resilience, and visibility in mind.
    </p>
==== /opt/webstack/html/testlayout.php ====
<?php
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

require 'layout.php';

$page_title = "Layout Test";

$content = <<<HTML
<section class="max-w-4xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">‚úÖ Layout Test</h1>
  <p class="text-lg">If you can see this inside the site‚Äôs background and nav/footer, layout.php is working properly.</p>
</section>
HTML;

renderLayout($page_title, $content);
==== /opt/webstack/html/analytics_logger.php ====
<?php
// --- KTP Digital Web Analytics Logger ---
// Universal logger: logs both public and admin page accesses

$client_ip = $_SERVER['REMOTE_ADDR'] ?? 'unknown';
$client_agent = $_SERVER['HTTP_USER_AGENT'] ?? 'unknown';
$is_admin = (strpos($_SERVER['SCRIPT_NAME'], '/admin/') !== false) ? 'ADMIN' : 'PUBLIC';

$start = $_SERVER['REQUEST_TIME_FLOAT'] ?? microtime(true);
register_shutdown_function(function() use ($start, $client_ip, $client_agent, $is_admin) {
    $elapsed = microtime(true) - $start;
    $log = sprintf(
        "[%s]\t%s\t%s\t%s\t%s\t%s\t%.3f\t%s\n",
        date('Y-m-d H:i:s'),
        $client_ip,
        $_SERVER['REQUEST_URI'] ?? 'unknown',
        $client_agent,
        $_SERVER['HTTP_REFERER'] ?? '-',
        http_response_code(),
        $elapsed,
==== /opt/webstack/html/older/about.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>About Jason Hollis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen px-6 py-12 flex flex-col">
  <?php include("nav.php"); ?>
  <main class="flex-grow max-w-3xl mx-auto space-y-6 mt-12">
    <h1 class="text-4xl font-bold text-yellow-400">About Jason Hollis</h1>
    <p class="text-gray-300">Jason is a cybersecurity, identity, and automation expert with over 35 years of global IT experience. From launching startups inside Symantec and CA Technologies to building secure smart homes for clients across Australia, he blends deep knowledge with hands-on problem-solving.</p>

    <ul class="list-disc list-inside text-gray-200 space-y-2">
      <li>Former VP Security, CA Technologies APJ</li>
      <li>Director at Symantec and Yubico</li>
      <li>Founder of KTP Digital & Rotacrem</li>
      <li>Based in Melbourne, working globally</li>
    </ul>
==== /opt/webstack/html/older/smallbiz.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Small Business IT Services | Jason Hollis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen px-6 py-12 flex flex-col">
  <?php include("nav.php"); ?>
  <main class="flex-grow max-w-3xl mx-auto space-y-8 mt-12">
    <h1 class="text-4xl font-bold text-blue-400">Small Business IT</h1>
    <p class="text-lg text-gray-300">Jason brings enterprise-grade infrastructure, network security, and cloud services to the small business world. Whether you're a sole trader or a 50-seat office, he'll help you build a secure and reliable environment.</p>

    <ul class="list-disc list-inside text-gray-200 space-y-2">
      <li>Office365 and Google Workspace management</li>
      <li>Firewall, router, and network switch deployment</li>
      <li>Cloud migration and data backup solutions</li>
      <li>End-user device security and patching</li>
      <li>Affordable SLA-style support tailored to you</li>
==== /opt/webstack/html/older/contact.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact Jason Hollis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen px-6 py-12 flex flex-col">
  <?php include("nav.php"); ?>
  <main class="flex-grow max-w-xl mx-auto space-y-8 mt-12">
    <h1 class="text-4xl font-bold text-teal-400">Contact Jason</h1>
    <p class="text-gray-300">Ready to work together? Whether it‚Äôs enterprise security, small business infrastructure, or home automation ‚Äî let‚Äôs talk.</p>

    <div class="space-y-2 text-sm text-gray-200">
      <p><strong>Email:</strong> <a href="mailto:jason@jasonhollis.com" class="underline">jason@jasonhollis.com</a></p>
      <p><strong>Phone:</strong> <a href="tel:+61400819487" class="underline">+61 400 819 487</a></p>
      <p><strong>LinkedIn:</strong> <a href="https://linkedin.com/in/jasonhollis" class="underline" target="_blank">linkedin.com/in/jasonhollis</a></p>
    </div>
  </main>
==== /opt/webstack/html/older/test.php ====
<?php // PHP webhook test: Sat May 17 02:52:43 AM UTC 2025 ?>
==== /opt/webstack/html/older/footer.php ====
<footer class="w-full bg-slate-800 text-gray-400 text-sm text-center py-4 mt-12 shadow-inner">
  &copy; <?= date('Y') ?> KTP Digital Pty Ltd ‚Äî Jason Hollis
</footer>
==== /opt/webstack/html/older/phpinfo.php ====
<?php phpinfo(); ?>
==== /opt/webstack/html/older/automation.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home Automation Services | Jason Hollis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen px-6 py-12 flex flex-col">
  <?php include("nav.php"); ?>
  <main class="flex-grow max-w-3xl mx-auto space-y-8 mt-12">
    <h1 class="text-4xl font-bold text-purple-400">Home Automation Consulting</h1>
    <p class="text-lg text-gray-300">Jason is a long-time Home Assistant user and community supporter, with real-world experience building secure, reliable automation environments for homes and rentals across Australia.</p>

    <ul class="list-disc list-inside text-gray-200 space-y-2">
      <li>Complete Home Assistant installs and migrations</li>
      <li>Multi-protocol integrations: Zigbee, Z-Wave, Thread, Matter</li>
      <li>Firewalling and network isolation for IoT devices</li>
      <li>Dashboard creation and remote access configuration</li>
      <li>Custom automations ‚Äî lighting, security, energy management</li>
==== /opt/webstack/html/older/index.php ====
<?php
$version = trim(file_get_contents('/opt/webstack/VERSION'));
$backgrounds = [
  "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80", // scuba
  "https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1600&q=80", // mountain
  "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80"  // night sky
];
$bg = $backgrounds[array_rand($backgrounds)];
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jason Hollis | IT Consulting & Automation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-image: url('<?= $bg ?>');
      background-size: cover;
==== /opt/webstack/html/older/enterprise.php ====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Enterprise IT Consulting | Jason Hollis</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen px-6 py-12 flex flex-col">
  <?php include("nav.php"); ?>
  <main class="flex-grow max-w-3xl mx-auto space-y-8 mt-12">
    <h1 class="text-4xl font-bold text-green-400">Enterprise Consulting</h1>
    <p class="text-lg text-gray-300">Jason Hollis has led security, identity, and endpoint architecture across Asia Pacific and Japan for Symantec, CA Technologies, and Yubico. He now delivers that expertise directly to clients who demand deep technical knowledge and reliable execution.</p>

    <ul class="list-disc list-inside text-gray-200 space-y-2">
      <li>Zero Trust Architecture & Identity Governance</li>
      <li>API Security, OAuth, SSO, and PAM design</li>
      <li>Microsoft 365, Office365 Security, Endpoint hardening</li>
      <li>Data sovereignty and regulatory compliance (AU, APJ)</li>
      <li>Custom frameworks for banks, telcos, and healthcare</li>
==== /opt/webstack/html/automation.php ====
<?php
require 'layout.php';

$page_title = "Automation & Home Assistant";

$content = <<<HTML
<section class="max-w-6xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">üè† Automation & Home Assistant</h1>
  <p class="mb-6 text-lg">
    From intelligent lighting to critical alerts, we design and deploy automations that are powerful, private, and resilient.
  </p>
  <ul class="list-disc list-inside text-left text-lg space-y-2">
    <li>Zigbee, Z-Wave, Thread, and Matter integrations</li>
    <li>Home Assistant installs on Raspberry Pi, Docker, or VM</li>
    <li>Custom dashboards and sensor automations</li>
    <li>Secure remote access via Tailscale</li>
    <li>Backup, monitoring, and rule-based alerting</li>
  </ul>
  <p class="mt-6 text-lg">
    We serve enthusiasts and professionals who want full control over their environment ‚Äî no cloud lock-in.
==== /opt/webstack/html/index.php ====
<?php
require 'layout.php';

$page_title = "KTP Digital | Smarter IT";

$content = <<<HTML
<h1 class="text-3xl sm:text-4xl font-bold">Smarter Infrastructure. Safer Systems. Automated Living.</h1>
<p class="text-base sm:text-lg text-gray-300">
  IT consulting from <strong>Jason Hollis</strong> ‚Äî trusted by enterprises, small businesses, and home automation power users.
</p>

<div class="grid gap-6 sm:grid-cols-2 text-left text-gray-200 mt-6 text-sm">
  <div>
    <h2 class="text-lg font-semibold text-green-400 mb-2">Enterprise Consulting</h2>
    <ul class="list-disc list-inside space-y-1">
      <li>Zero Trust & Identity Architecture</li>
      <li>API Security & Governance</li>
      <li>Office365, Endpoint & Compliance</li>
    </ul>
  </div>
==== /opt/webstack/html/newindex.php ====
<?php include("nav.php"); ?>
<div class="pt-24 sm:pt-20"></div>
<?php
  $version = trim(file_get_contents('/opt/webstack/html/VERSION'));
  $bg = "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&w=1600&q=80";
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.tailwindcss.com"></script>
  <title>KTP Digital | Smarter IT</title>
  <style>
    body {
      background-image: url('<?= $bg ?>');
      background-size: cover;
      background-position: center;
    }
    .backdrop {
==== /opt/webstack/html/enterprise.php ====
<?php
require 'layout.php';

$page_title = "Enterprise Consulting";

$content = <<<HTML
<section class="max-w-6xl mx-auto p-6">
  <h1 class="text-4xl font-bold mb-4">üè¢ Enterprise Consulting</h1>
  <p class="mb-6 text-lg">
    With decades of leadership across APJ, EMEA, and the US, we bring a pragmatic, outcome-driven approach to complex enterprise IT challenges.
  </p>
  <ul class="list-disc list-inside text-left text-lg space-y-2">
    <li>Identity Management & Zero Trust Architecture</li>
    <li>API security, governance, and integration</li>
    <li>Endpoint, data, and infrastructure protection</li>
    <li>IAM, PAM, CMDB, and ITSM strategy</li>
    <li>Vendor-agnostic recommendations and hands-on deployment</li>
  </ul>
  <p class="mt-6 text-lg">
    We've delivered outcomes for governments, financial institutions, healthcare providers, and major multinationals.
==== /opt/webstack/html/prose-test.html ====
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="/assets/tailwind.min.css">
</head>
<body>
  <div class="prose prose-invert">
    <h1>Hello, Tailwind Prose!</h1>
    <p>If you see big styled text, it‚Äôs working.</p>
    <ul><li>First</li><li>Second</li></ul>
  </div>
</body>
</html>
root@ssdnodes-605e9a6080011:/opt/webstack/bin# 

---
#### [2025-05-20 19:47:46 AEST][v1.4.2-dev]
Analysis of /opt/webstack/html PHP/HTML Structure
1. Entrypoint/Include Analysis

Most main pages (index.php, smallbiz.php, automation.php, enterprise.php, contact.php, about.php, etc.) use require 'layout.php'; (not nav.php directly).
Some pages (e.g. mac.php, tailscale.php, nextdns.php, nas.php) use <?php include 'nav.php'; ?> directly.
Some "test" and legacy files include nav.php or none at all.
Admin pages (e.g. maintenance.php, changes.php) sometimes don‚Äôt include either header‚Äîthey just have the raw HTML with nav.
2. Layout System

layout.php is a rendering helper, so any page that uses it will get nav/footer/branding via its internal logic.
Pages using layout.php will NOT have the analytics logger unless it's added to layout.php (top).
Pages including nav.php directly (not via layout) need the logger at the top of their file.
3. Legacy/Unused/Old Files

/older/ directory: Clearly legacy‚Äîsafe to ignore or archive.
Files like test.php, testlayout.php, index-test.php, newindex.php, etc., are likely not part of live routes.
4. Files Likely in Use (Main Site)

/opt/webstack/html/index.php
/opt/webstack/html/about.php
/opt/webstack/html/enterprise.php
/opt/webstack/html/smallbiz.php
/opt/webstack/html/automation.php
/opt/webstack/html/contact.php
/opt/webstack/html/mac.php
/opt/webstack/html/nextdns.php
/opt/webstack/html/tailscale.php
/opt/webstack/html/nas.php
/opt/webstack/html/admin/maintenance.php
/opt/webstack/html/admin/changes.php
5. Recommendations

A. Inject analytics logger in one place for all layout.php-driven pages:

Add include __DIR__.'/analytics_logger.php'; to the very top of layout.php.
All main content pages using the layout will now be logged.
B. For all pages that only include nav.php or are plain HTML:

Add include __DIR__.'/analytics_logger.php'; at the top of those PHP files.
C. For admin pages:

Add include __DIR__.'/../analytics_logger.php'; at the very top, if not already present.
D. Ignore .html and /older/ files unless they‚Äôre still in use.

---
#### [2025-05-20 19:48:30 AEST][v1.4.2-dev]
Summary Table

File/Pattern	Logger Injection	Notes
layout.php	At top of file	Covers most main content
mac.php, tailscale.php, etc	Top of each file	(If not using layout.php)
admin/*.php	Top of each file	Use ../analytics_logger.php
/older/, test.php, *.html	Ignore/Archive	Not used/live
Cleanup & Patch Plan

Add this to the top of layout.php:
<?php include __DIR__.'/analytics_logger.php'; ?>
Add this to the top of all public PHP pages NOT using layout.php:
<?php include __DIR__.'/analytics_logger.php'; ?>
Add this to the top of all admin PHP pages:
<?php include __DIR__.'/../analytics_logger.php'; ?>

---
#### [2025-05-20 19:51:10 AEST][v1.4.2-dev]
Want a shell script to automate this (sed/in-place insert for all relevant files)?
Or do you want the precise EOF patches for each file?
Let me know how aggressive you want to be about cleaning up/archiving the /older/ files and test pages!

Forget about older completely.  We should run a quick snapshot manually and then sed it

